


# Перед тем как запустить
Для запуска скрипта необходимо заполнить переменные которые находятся:
- inventory/hosts
- inventory/group_vars/all/main.yml  ( не обязательно )
# Запуск плейбука
Для запуска плейбука используйте следующую команду

```
ANSIBLE_HOST_KEY_CHECKING=False ansible-playbook -i ../inventory/hosts --user root --private-key ~/.ssh/id_rsa ../ds-cluster.yml
```

- ANSIBLE_HOST_KEY_CHECKING: Это параметр проверки ключа на конечном хосте.
- ansible-playbook: Это команда для запуска плейбука  (файлов YAML, содержащих инструкции для управления удаленными системами).
- -i ../inventory/hosts: Этот флаг '-i' указывает путь до файла hosts который содержит информацию о хостах.
- --user: - Этот флаг указывает имя пользователя, под которым Ansible будет выполнять команды на удаленных хостах.
- --private-key: Этот флаг указывает путь к закрытому ключу (id_rsa), который будет использоваться для аутентификации при подключении к удаленным хостам.
- ../cs.yml: Это путь к файлу плейбука (cs.yml), который будет выполнен Ansible.

# Описание глобальных переменных 

Глобальные переменные находятся по пути ``ds-cluster/inventory/group_vars/all/mail.yml``


| vars | description |
|-------|-------------|
|redis | ip адрес хоста для Redis сервера. Берет значение  ansible_host  из файла inventory/hosts|
|rabbit| ip адрес хоста для RabbitMQ сервера. Берет значение  ansible_host  из файла inventory/hosts|
|postgresql | ip адрес хоста для базы данных PostgreSQL . Берет значение  ansible_host  из файла inventory/hosts|
|nfs |ip адрес хоста для nfs сервера. Берет значение  ansible_host  из файла inventory/hosts |
|nginx |ip адрес хоста для nginx сервера. Берет значение  ansible_host  из файла inventory/hosts | 
| ds_cluster | ip адреса для Сервера Документов . Берет значение  ansible_host  из файла inventory/hosts |
|DS_db_psql | имя базы данных postgresql |
|DS_psql_user | пользователь для входа в postgresql  |
|DS_psql_pass| пароль для входа в postgresql |
|rmq_user | пользователь для входа в rabbitMQ |
|rmq_password| пароль ддля входа в rabbitMQ |
|nfs_directory_cache | путь до директории в которой будет хранится кэш документ сервера |
|nfs_directory_data |  путь до директории в которой будут храниться данные документ сервера |
|JWT_SECRET | определяет секретную строку, которая используется для подписи URL-адреса.|
|SECURE_LINK_SECRET | определяет заголовок HTTP, который будет использоваться для отправки токена входящего запроса. |
|JWT_HEADER |  определяет заголовок HTTP, который будет использоваться для отправки токена исходящего запроса. |

# Описание переменных hosts

| vars | description |
|-------|-------------|
| redis | группа к которой применяется роль для установки  Redis сервера |
| rabbit | группа к которой применяется роль для установки  RabbitMQ сервера |
| postgresql | группа к которой применяется роль для установки  PostgreSQL сервера  |
| nfs | группа к которой применяется роль для установки  Nfs сервера  |
|nginx|группа к которой применяется роль для установки  Nginx сервера  |
|ds_cluster| группа к которой применяется роль для установки нескольких документ серверов  |
|ansible_host| ip адрес хоста |
|ansible_port|порт для подключения через ssh ( по умолчанию 22)|
|ansible_user|пользователь для подключения по ssh|

# Поддерживаемые ОС

- Debian 11 (Bullseye) 64-bit ( требутеся перезагрузка ds хостов после регистрации CS )
- Debian 10 (Buster) 64-bit ( требутеся перезагрузка ds хостов после регистрации CS )
- Ubuntu 18.04 LTS 64-bit ( требутеся перезагрузка ds хостов после регистрации CS )
- Ubuntu 20.04 LTS 64-bit ( требутеся перезагрузка ds хостов после регистрации CS )
- Ubuntu 22.04 LTS 64-bit ( требутеся перезагрузка ds хостов после регистрации CS )
- Astra_1.7.3orel_ssh_rdp ( требутеся перезагрузка ds хостов после регистрации CS )
- RedOS_7.3.2_ssh_rdp
- CentOS 7 64-bit

## Лицензирование Документ сервера
Если у вас есть лицензия для документ сервера, ее необходимо переместить в папку roles/ds_cluster/files/license.lic
